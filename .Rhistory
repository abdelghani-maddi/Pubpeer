# Ajuster un modèle de régression logistique
modele_logit <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`,
data = bdd_regr,
family = binomial)
summary(modele_logit)
# Regression ----
# Ajuster un modèle de régression logistique
modele_logit1 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`,
data = bdd_regr,
family = binomial)
summary(modele_logit1)
## variables de controle
modele_logit1 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
bdd_regr$Nombre.de.commentaires,
data = bdd_regr,
family = binomial)
summary(modele_logit1)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires),
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) + log(bdd_regr$nb_aut + log(bdd_regr$Journal_H_index_2021) + log(bdd_regr$Journal_Rank_SJR_2021)),
data = bdd_regr,
family = binomial)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) + log(bdd_regr$nb_aut + log(1+bdd_regr$Journal_H_index_2021) + log(1+bdd_regr$Journal_Rank_SJR_2021)),
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut +
log(1+bdd_regr$Journal_H_index_2021) +
log(1+bdd_regr$Journal_Rank_SJR_2021)),
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(1+bdd_regr$Journal_H_index_2021) +
log(1+bdd_regr$Journal_Rank_SJR_2021),
data = bdd_regr,
family = binomial)
summary(modele_logit2)
esquisse:::esquisser()
names(bdd_pub)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(1+bdd_regr$Journal_H_index_2021) +
log(bdd_regr$Journal_Rank_SJR_2021),
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021),
data = bdd_regr,
family = binomial)
summary(modele_logit2)
names(bdd_regr)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$Africa +
bdd_regr$`Africa/Middle East` +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe` +
bdd_regr$`Latin America`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$Africa +
bdd_regr$`Middle East` +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe` +
bdd_regr$`Latin America`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$Africa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe` +
bdd_regr$`Latin America`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$Africa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe` +
data = bdd_regr,
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$Africa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`
data = bdd_regr,
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$Africa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`
data = bdd_regr,
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$Africa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
names(bdd_regr)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe` +
bdd_regr$`Africa/Middle East`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men-women` + bdd_regr$`Collab. men only` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
names(bdd_regr)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa
# bdd_regr$`Asiatic Region` +
# bdd_regr$`Northern America` +
# bdd_regr$`Western Europe`,
data = bdd_regr,
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa ,
# bdd_regr$`Asiatic Region` +
# bdd_regr$`Northern America` +
# bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa ,
# bdd_regr$`Asiatic Region` +
# bdd_regr$`Northern America` +
# bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
# Regression ----
# Ajuster un modèle de régression logistique
modele_logit1 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`,
data = bdd_regr,
family = binomial)
summary(modele_logit1)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
View(bdd_pub)
reqsql= paste('select distinct publication, discipline from commentaires_par_discipline')
data_disc = dbGetQuery(con,reqsql)
## ajout des disciplines
bdd_regr <- bdd_regr %>%
left_join(., data_disc, by = "publication")
View(bdd_regr)
# Pivoter la discipline pour n'analyse
bdd_regr <- pivot_wider(bdd_regr, names_from = discipline, values_from = discipline, values_fn = list(discipline = function(x) 1),
values_fill = list(discipline = 0))
View(bdd_regr)
## ajout des disciplines
bdd_regr <- bdd_regr %>%
left_join(., data_disc, by = "publication") %>%
subset(., !is.na(discipline))
View(bdd_regr)
### Bdd
bdd_regr <- bdd_pub %>%
left_join(., df_nb_aut[,c(1,2,18,19,20)], by = "publication") %>%
select(publication, Retracted, Gtype, nb_aut, Nombre.de.commentaires, Journal_H_index_2021, Journal_Rank_SJR_2021, Journal_Région) %>%
left_join(., row_data, by = "publication")
## Opérations sur les variables
bdd_regr$Retracted <- factor(bdd_regr$Retracted)
bdd_regr$is_oa <- factor(bdd_regr$is_oa)
## Recoding bdd_regr$Retracted
bdd_regr$Retracted_rec <- bdd_regr$Retracted %>%
fct_recode(
"0" = "False",
NULL = "None",
"1" = "True"
)
## Recoding bdd_regr$oa_status into bdd_regr$oa_status_rec
bdd_regr$oa_status <- bdd_regr$oa_status %>%
fct_recode(
"bronze" = "'bronze'",
"closed" = "'closed'",
"gold" = "'gold'",
"green" = "'green'",
"hybrid" = "'hybrid'"
)
## Recoding bdd_regr$is_oa
bdd_regr$is_oa <- bdd_regr$is_oa %>%
fct_recode(
NULL = "",
"0" = "False",
"1" = "True"
)
## Recoding bdd_regr$Gtype
bdd_regr$Gtype <- bdd_regr$Gtype %>%
fct_explicit_na("Gtype_na")
# Pivoter le type de collabe H-F pour n'analyse
bdd_regr <- pivot_wider(bdd_regr, names_from = Gtype, values_from = Gtype, values_fn = list(Gtype = function(x) 1),
values_fill = list(Gtype = 0))
## Recoding bdd_regr$Journal_Région
bdd_regr$Journal_Région <- bdd_regr$Journal_Région %>%
fct_recode(
"None" = ""
)
# Pivoter la région pour n'analyse
bdd_regr <- pivot_wider(bdd_regr, names_from = Journal_Région, values_from = Journal_Région, values_fn = list(Journal_Région = function(x) 1),
values_fill = list(Journal_Région = 0))
bdd_regr <- subset(bdd_regr, complete.cases(bdd_regr)) %>%
select(., -None, -Gtype_na) # toutes leurs valeurs sont nulles car filtre précédent
## ajout des disciplines
bdd_regr <- bdd_regr %>%
left_join(., data_disc, by = "publication") %>%
subset(., !is.na(discipline))
View(bdd_regr)
# Pivoter la discipline pour n'analyse
bdd_regr <- pivot_wider(bdd_regr, names_from = discipline, values_from = discipline, values_fn = list(discipline = function(x) 1),
values_fill = list(discipline = 0))
View(bdd_regr)
# Regression ----
# Ajuster un modèle de régression logistique
modele_logit1 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`,
data = bdd_regr,
family = binomial)
summary(modele_logit1)
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
## variables de controle : discipline
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe` +
bdd_regr$`Social Sciences` +
bdd_regr$Multidisciplinary +
bdd_regr$`Physical Sciences` +
bdd_regr$Technology +
bdd_regr$`Arts Humanities`,
data = bdd_regr,
family = binomial)
## variables de controle : discipline
modele_logit3 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe` +
bdd_regr$`Social Sciences` +
bdd_regr$Multidisciplinary +
bdd_regr$`Physical Sciences` +
bdd_regr$Technology +
bdd_regr$`Arts Humanities`,
data = bdd_regr,
family = binomial)
summary(modele_logit3)
# Calculer le coefficient de détermination R^2
R2 <- 1 - (modele_logit3$deviance / modele_logit$null.deviance)
cat("R^2 : ", R2, "\n")
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
# Calculer le coefficient de détermination R^2
R2 <- 1 - (modele_logit2$deviance / modele_logit$null.deviance)
cat("R^2 : ", R2, "\n")
# Calculer le coefficient de détermination R^2
R2 <- 1 - (modele_logit1$deviance / modele_logit$null.deviance)
cat("R^2 : ", R2, "\n")
## variables de controle
modele_logit2 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe`,
data = bdd_regr,
family = binomial)
summary(modele_logit2)
# Calculer le coefficient de détermination R^2
R2 <- 1 - (modele_logit2$deviance / modele_logit$null.deviance)
cat("R^2 : ", R2, "\n")
## variables de controle : discipline
modele_logit3 <- glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`+
log(bdd_regr$Nombre.de.commentaires) +
log(bdd_regr$nb_aut) +
log(bdd_regr$Journal_Rank_SJR_2021) +
is_oa +
bdd_regr$`Asiatic Region` +
bdd_regr$`Northern America` +
bdd_regr$`Western Europe` +
bdd_regr$`Social Sciences` +
bdd_regr$Multidisciplinary +
bdd_regr$`Physical Sciences` +
bdd_regr$Technology +
bdd_regr$`Arts Humanities`,
data = bdd_regr,
family = binomial)
summary(modele_logit3)
# Calculer le coefficient de détermination R^2
R2 <- 1 - (modele_logit3$deviance / modele_logit$null.deviance)
cat("R^2 : ", R2, "\n")
# Afficher l'AIC et le BIC du modèle
AIC(modele_logit)
# Afficher l'AIC et le BIC du modèle
AIC(modele_logit3)
BIC(modele_logit3)
# Afficher les statistiques de Wald
summary(modele_logit)$coefficients[, "Pr(>|z|)"]
# Afficher les statistiques de Wald
summary(modele_logit3)$coefficients[, "Pr(>|z|)"]
library(caret)
install.packages("caret")
install.packages("caret")
library(caret)
library(caret)
library(caret)
library(boot)
library(boot)
set.seed(123)
folds <- createFolds(bdd_retract$Retract, k = 5, list = TRUE, returnTrain = FALSE)
install.packages("caret")
library(caret)
library(caret)
library(boot)
set.seed(123)
folds <- createFolds(bdd_retract$Retract, k = 5, list = TRUE, returnTrain = FALSE)
install.packages("rsample")
library(rsample)
folds <- vfold_cv(bdd_regr, v = 5, repeats = 1)
results <- folds %>%
mutate(model = map(splits, ~glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`, data = analysis(.), family = binomial)),
predict = map(model, ~predict(object = .x, newdata = assessment(.), type = "response")),
accuracy = map2_dbl(predict, splits$assessment, ~mean((.x > 0.5) == .y$Retracted)))
library(dplyr)
results <- folds %>%
mutate(model = map(splits, ~glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`, data = analysis(.), family = binomial)),
predict = map(model, ~predict(object = .x, newdata = assessment(.), type = "response")),
accuracy = map2_dbl(predict, splits$assessment, ~mean((.x > 0.5) == .y$Retracted)))
library(rsample)
library(boot)
folds <- vfold_cv(bdd_regr, v = 5, repeats = 1)
library(dplyr)
results <- folds %>%
mutate(model = map(splits, ~glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`, data = analysis(.), family = binomial)),
predict = map(model, ~predict(object = .x, newdata = assessment(.), type = "response")),
accuracy = map2_dbl(predict, splits$assessment, ~mean((.x > 0.5) == .y$Retracted)))
library(tidyverse)
library(tidyverse)
results <- folds %>%
mutate(model = map(splits, ~glm(Retracted ~ bdd_regr$`Collab. men only` + bdd_regr$`Collab. men-women` + bdd_regr$`Collab. women only` + bdd_regr$`Man alone`, data = analysis(.), family = binomial)),
predict = map(model, ~predict(object = .x, newdata = assessment(.), type = "response")),
accuracy = map2_dbl(predict, splits$assessment, ~mean((.x > 0.5) == .y$Retracted)))
rm(list = ls()) #supprimer tous les objets
library(tidyverse)
library(gtsummary)
library(tidyverse)
rm(list = ls()) #supprimer tous les objets
library(tidyverse)
rm(list = ls()) #supprimer tous les objets
source("~/Documents/Pubpeer project/Pubpeer/Gender st.R", echo=TRUE)
