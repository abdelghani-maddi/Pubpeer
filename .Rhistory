tbl_summary() %>%
modify_header(label ~ "**Year**")
##
## Recoding df2$annee into df2$annee_rec
df2$annee_rec <- df2$annee %>%
fct_recode(
"2000-2005" = "2000",
"2000-2005" = "2001",
"2000-2005" = "2002",
"2000-2005" = "2003",
"2000-2005" = "2004",
"2000-2005" = "2005",
"2006-2010" = "2006",
"2006-2010" = "2007",
"2006-2010" = "2008",
"2006-2010" = "2009",
"2006-2010" = "2010",
"2011-2015" = "2011",
"2011-2015" = "2012",
"2011-2015" = "2013",
"2011-2015" = "2014",
"2011-2015" = "2015",
"2016-2020" = "2016",
"2016-2020" = "2017",
"2016-2020" = "2018",
"2016-2020" = "2019",
"2016-2020" = "2020"
)
tbl_summary(df2)
df2[] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**")
##
## Recoding df2$annee into df2$annee_rec
df2$annee_rec <- df2$annee %>%
fct_recode(
"1999"      = NA
"2000-2005" = "2000",
##
## Recoding df2$annee into df2$annee_rec
df2$annee_rec <- df2$annee %>%
fct_recode(
"1999"      = NA,
"2000-2005" = "2000",
"2000-2005" = "2001",
"2000-2005" = "2002",
"2000-2005" = "2003",
"2000-2005" = "2004",
"2000-2005" = "2005",
"2006-2010" = "2006",
"2006-2010" = "2007",
"2006-2010" = "2008",
"2006-2010" = "2009",
"2006-2010" = "2010",
"2011-2015" = "2011",
"2011-2015" = "2012",
"2011-2015" = "2013",
"2011-2015" = "2014",
"2011-2015" = "2015",
"2016-2020" = "2016",
"2016-2020" = "2017",
"2016-2020" = "2018",
"2016-2020" = "2019",
"2016-2020" = "2020"
)
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**")
df2[,c(3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**")
df2[,3] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**")
df2[,3]
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_cross(
row = annee
) %>%
modify_header(label ~ "**Year**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_cross(
row = annee_rec
) %>%
modify_header(label ~ "**Year**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
tbl_svysummary(include = c(annee_rec, rev))
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
tbl_svysummary(include = c(annee_rec))
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**") %>%
add_overall()
df2[,c(2,3)] %>%
select(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**") %>%
add_overall()
df2[,c(2,3)] %>%
select(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary() %>%
modify_header(label ~ "**Year**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review (number of words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review n/(number of words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review /n (number of words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review /(number of words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2 <- data.frame(factor(df$ANNEE_PUBLICATION[!="1999"]), df$REVIEW_LENGTH_WORDS)
df2 <- data.frame(factor(df$ANNEE_PUBLICATION[ANNEE_PUBLICATION!="1999"]), df$REVIEW_LENGTH_WORDS)
df2 <- data.frame(factor(df$ANNEE_PUBLICATION[df$ANNEE_PUBLICATION!="1999"]), df$REVIEW_LENGTH_WORDS)
df2 <- data.frame(factor(df$ANNEE_PUBLICATION), df$REVIEW_LENGTH_WORDS)
names(df2) = c("annee", "rev")
df2 <- select(df2, df2$annee != 1999)
df2 <- select(df2, df2$annee != "1999")
`%not_in%` <- purrr::negate(`%in%`)
df2 <- select(df2, df2$annee not_in "1999")
df2 <- select(df2, annee not_in "1999")
df2 <- select(df2, annee not_in c("1999"))
df2 <- select(df2, annee %not_in% c("1999"))
df2 <- select(df2, df2$annee %not_in% c("1999"))
df2 <- select(df2, as.integer(df2$annee) !=1999)
df2 <- select(df2, as.numeric(df2$annee) !=1999)
df2 <- subset(df2, as.numeric(df2$annee) !=1999)
df2 <- subset(df2, as.numeric(df2$annee) !=1999)
as.numeric(df2$annee) !=1999
df2 <- subset(df2, as.numeric(df2$annee) =1999)
df2 <- subset(df2, as.numeric(df2$annee)==1999)
as.numeric(df2$annee)
df2$annee
as.numeric(df2$annee)
df2 <- subset(df2, as.integer(df2$annee)==1999)
as.integer(df2$annee)
df2[,c(2,3)] %>%
tbl_summary(
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
tbl_summary(
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2 <- data.frame(factor(df$ANNEE_PUBLICATION), df$REVIEW_LENGTH_WORDS)
names(df2) = c("annee", "rev")
##
## Recoding df2$annee into df2$annee_rec
df2$annee_rec <- df2$annee %>%
fct_recode(
"2000-2005" = "2000",
"2000-2005" = "2001",
"2000-2005" = "2002",
"2000-2005" = "2003",
"2000-2005" = "2004",
"2000-2005" = "2005",
"2006-2010" = "2006",
"2006-2010" = "2007",
"2006-2010" = "2008",
"2006-2010" = "2009",
"2006-2010" = "2010",
"2011-2015" = "2011",
"2011-2015" = "2012",
"2011-2015" = "2013",
"2011-2015" = "2014",
"2011-2015" = "2015",
"2016-2020" = "2016",
"2016-2020" = "2017",
"2016-2020" = "2018",
"2016-2020" = "2019",
"2016-2020" = "2020"
)
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
starts_with("2"),
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
starts_with("2") ~ "tt",
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(
all_continuous() ~ "Variable continue",
all_categorical(dichotomous = FALSE) ~ "Variable catégorielle")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
include = c("annee")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**")
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**") %>%
add_overall()
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
by = rev
label = list(rev ~ "Length-review (# words)",
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
by = .$rev
label = list(rev ~ "Length-review (# words)",
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
by = "rev"
label = list(rev ~ "Length-review (# words)",
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
by = "rev",
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**") %>%
add_overall()
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review (# words)",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**Variables**") %>%
add_overall()
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review-words",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**# Reports**") %>%
add_overall()
df2[,c(2,3)] %>%
filter(., .$annee != '1999') %>%
tbl_summary(
label = list(rev ~ "Length-review-words",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**# Reports**")
df2[,c(2,3)] %>%
tbl_summary(
label = list(rev ~ "Length-review-words",
annee_rec ~ "Period")
) %>%
modify_header(label ~ "**# Reports**")
df2[,c(2,3)] %>%
tbl_summary(
label = list(rev ~ "Length-review-words",
annee_rec ~ "Period"),
statistic = all_continuous() ~ "Moy. : {mean} [min-max : {min} - {max}]"
) %>%
modify_header(label ~ "**# Reports**")
df2[,c(2,3)] %>%
tbl_summary(
label = list(rev ~ "Length-review-words",
annee_rec ~ "Period"),
statistic = all_continuous() ~ "Med. : {median} [{mean} - {sd}]"
) %>%
modify_header(label ~ "**# Reports**")
df2[,c(2,3)] %>%
tbl_summary(
label = list(rev ~ "Length-review-words",
annee_rec ~ "Period"),
statistic = all_continuous() ~ "Stat. : {median} [{mean} - {sd}]"
) %>%
modify_header(label ~ "**# Reports**")
df2[,c(2,3)] %>%
tbl_summary(
label = list(rev ~ "Length-review-words",
annee_rec ~ "Period"),
statistic = all_continuous() ~ "Med. : {median} [{mean} - {sd}]"
) %>%
modify_header(label ~ "**# Reports**")
esquisse:::esquisser()
range(df2$rev)
esquisse:::esquisser()
rm(list = ls()) #supprimer tous les objets
# chargement des packages ----
library(stringr)
library(tibble)
library(tidytext)
library(textdata)
library(Hmisc)
library(zoo)
library(flextable)
library(DBI)
library(data.table)
library(tidyverse)
library(trimmer)
library(DescTools)
library(questionr)
library(RPostgres)
library(lubridate)
library(timechange)
library(urltools)
library(stringr)
library(rebus)
library(Matrix)
library(plyr)
library(sjmisc)
# chargement des packages ----
library(stringr)
library(tibble)
library(tidytext)
library(textdata)
library(Hmisc)
library(zoo)
library(flextable)
library(DBI)
library(data.table)
library(tidyverse)
con<-dbConnect(RPostgres::Postgres())
db <- 'SKEPTISCIENCE'  #provide the name of your db
host_db <- 'localhost' # server
db_port <- '5433'  # port DBA
db_user <- 'postgres' # nom utilisateur
db_password <- 'Maroua1912'
con <- dbConnect(RPostgres::Postgres(), dbname = db, host=host_db, port=db_port, user=db_user, password=db_password)
# Test connexion
dbListTables(con)
### Récupération des données ----
reqsql= paste('select inner_id, publication, html as comm from data_commentaires')
data_comm = dbGetQuery(con,reqsql)
data_comm[1,]
### Récupération des commentaires avec liens hypertextes ----
# Creer la liste des liens qui se trouvent dans les commentaires gardant
# le lien avec les publications à partir desquelles sont extraits
#### Etape 0 : Transformer le type de données pour plus de facilité/performance dans le traitement ----
URL_var <- as_tibble(data_comm) %>% # Etape 0
#### Etape 1 : Se limiter aux commentaires avec au moins un lien hypertexte  ----
subset(., comm %like% c("%https%","%http%","%www%","%WWW%")) %>% # Etape 1
#### Etape 2 : Recupérer uniquement les commentaires (l'intérêt de garder le subset est de pouvoir selectionner par la suite les disciplines aussi) ----
.$comm # Etape 2
#### Etape 3 : nommer le vecteur avec l'identifiant des publications ----
names(URL_var) <- subset(data_comm$publication, data_comm$comm %like% c("%https%","%http%","%www%","%WWW%")) # Etape 3
#### Etape 4 : Créer un pattern pour l'extraction des URL ----
pat<- "//" %R% capture(one_or_more(char_class(WRD,DOT)))
#### Etape 5 : Utiliser "rebus" pour extraire l'URL principal ----
URL_extract<-str_extract_all(URL_var, "(?<=//)[^\\s/:]+") #URL_extract<-str_match_all(URL_var, pattern = pat)
# Attribuer aux liens, les identifiants des publications d'où ils sont issus ----
names(URL_extract) <- names(URL_var)
# Transformer en liste de dataframe
list_data <- Map(as.data.frame, URL_extract) %>%
rbindlist(., use.names = F, idcol = names(.))
names(list_data) = c("publication", "site")
df = data.frame(list_data$publication, factor(list_data$site))
names(df) = c("publication", "site")
# list_data[list_data$publication == "106541"] -- petit test -- OK :)
# Nettoyer les données et préparer des fichiers txt pour vosviewer ----
`%not_like%` <- purrr::negate(`%like%`)
donnees <- list_data[df$site %like% "%\\.%"]
donnees2 <- data.frame(donnees$publication, stringr::str_remove_all(donnees$site, "[\\p{P}\\p{S}&&[^.]]"))
names(donnees2) = c("publication", "site")
donnees3 <- data.frame(as.integer(donnees2$publication), donnees2$site)
names(donnees3) = c("publication", "site")
## Exportation des données ----
dbWriteTable(conn = con, "publication_sites_comm", donnees3)
View(donnees3)
donnees3 %>% factor(donnees3$publication)
donnees3 %>% factor(donnees3$site)
## factor
t <- data.frame(donnees$publication, factor(donnees3$site))
names(t) <- c("publication","site")
questionr:::irec()
t$site |>
fct_infreq() |>
fct_rev() |>
questionr::freq()
tbl_summary(t)
describe(t)
library(questionr)
questionr::describe(t)
questionr::describe(t$site)
freq(t$site)
t$site |>
fct_infreq() |>
questionr::freq()
freqsit <- t$site |>
fct_infreq() |>
questionr::freq()
esquisse:::esquisser()
View(freqsit)
freqsit <- t$site |>
fct_infreq() |>
questionr::freq() %>%
rownames(freqsit)
freqsit <- t$site |>
fct_infreq() |>
questionr::freq()
rownames(freqsit)
f <- t$site |>
fct_infreq() |>
questionr::freq()
freqsit <- data.frame(rownames(freqsit),f)
View(list_data)
View(freqsit)
View(freqsit)
names(freqsit) = c("site","nb","part","freq")
esquisse:::esquisser()
View(list_data)
View(t)
View(freqsit)
esquisse:::esquisser()
esquisse:::esquisser()
questionr:::irec()
questionr:::irec()
questionr:::irec()
View(freqsit)
reprex:::reprex_addin()
devtools::install_github("gadenbuie/regexplain")
devtools::install_github("gadenbuie/regexplain")
source("https://install-github.me/gadenbuie/regexplain")
install.packages("regexPipes")
install.packages("regexSelect")
remotes::install_github("gadenbuie/regexplain")
install.packages("https://github.com/gadenbuie/regexplain")
remotes::install_github("gadenbuie/regexplain")
install.packages('remotes')
remotes::install_github("gadenbuie/regexplain")
library(regexplain)
